<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Panel | Upload Anime DP</title>

<style>
    body{
        background:#0a0a0a;
        color:#fff;
        font-family:Arial, sans-serif;
        margin:0;
        padding:0;
        text-align:center;
    }
    h2{margin-bottom:10px;}

    /* LOGIN BOX */
    #loginBox{
        width:90%;
        max-width:300px;
        margin:90px auto;
        padding:25px;
        background:#161616;
        border-radius:8px;
        animation:fade .3s;
    }

    /* ADMIN PANEL */
    #adminPanel{
        width:90%;
        max-width:450px;
        margin:60px auto;
        background:#181818;
        padding:25px;
        border-radius:10px;
        display:none;
        animation:fade .4s;
    }

    input{
        width:100%;
        padding:10px;
        margin:8px 0;
        border:none;
        outline:none;
        border-radius:6px;
        background:#292929;
        color:#fff;
    }

    button{
        width:100%;
        padding:11px;
        margin-top:10px;
        font-weight:bold;
        border:none;
        border-radius:6px;
        background:#ff0055;
        color:white;
        cursor:pointer;
        transition:.2s;
    }
    button:hover{opacity:.8;}

    #status{
        margin-top:10px;
        font-size:15px;
        font-weight:bold;
    }

    @keyframes fade{
        from{opacity:0; transform:scale(.97);}
        to{opacity:1; transform:scale(1);}
    }
</style>
</head>
<body>


<!-- üîê LOGIN SCREEN -->
<div id="loginBox">
    <h2>Admin Login</h2>
    <input type="password" id="pass" placeholder="Enter Password">
    <button onclick="login()">Login</button>
    <p id="logStatus" style="color:#ff6b6b;margin-top:6px;"></p>
</div>


<!-- üõ† ADMIN UPLOAD PANEL -->
<div id="adminPanel">
    <h2>üöÄ Upload Anime DP</h2>

    <input type="file" id="fileInput" accept="image/*">
    <input type="text" id="fileName" placeholder="example.jpg (optional)">
    <input type="text" id="tags" placeholder="Tags: anime,boy,dark">

    <button id="uploadBtn">Upload</button>
    <p id="status"></p>
</div>
 <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
/***************  SUPABASE CONFIG (FIXED) ***************/
const SUPABASE_URL = "https://uekehssbugjcdjopietz.supabase.co";
const SUPABASE_KEY = "sb_publishable_DhiBec9_K-jgfAuaXLOIJw_7TKC7BBU";

const { createClient } = window.supabase;          // ‚úÖ Correct import
const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

const bucketName = "images";

/***************  PASSWORD LOGIN  ***************/
const ADMIN_PASS = "Akukamithelegend";

function login(){
    let input = document.getElementById("pass").value;

    if(input === ADMIN_PASS){
        document.getElementById("loginBox").style.display="none";
        document.getElementById("adminPanel").style.display="block";
    }else{
        document.getElementById("logStatus").innerHTML="‚ùå Wrong Password";
    }
}

/***************  UPLOAD FUNCTION  ***************/
document.getElementById("uploadBtn").onclick = async ()=>{
    
    const file = document.getElementById("fileInput").files[0];
    const manualName = document.getElementById("fileName").value.trim();
    const tags = document.getElementById("tags").value.split(",").map(t=>t.trim());
    const status = document.getElementById("status");

    if(!file){
        status.innerHTML="‚ö† Select an image";
        status.style.color="#ff6b6b";
        return;
    }

    // Auto-generate filename if not given
    let fileName = manualName !== "" ? manualName : file.name;
    fileName = fileName.replace(/\s+/g,"_").toLowerCase();

    status.innerHTML="Uploading... ‚è≥";
    status.style.color="#fff";

    // 1Ô∏è‚É£ Upload Image
    let { error: uploadError } = await supabase.storage
      .from(bucketName)
      .upload(fileName, file, { upsert:true });

    if(uploadError){
        status.innerHTML="‚ùå Upload Failed";
        status.style.color="#ff6b6b";
        return;
    }

    // 2Ô∏è‚É£ Insert DB entry
    await supabase.from("images").insert({file:fileName,tags:tags});

    status.innerHTML="‚úÖ Uploaded Successfully!";
    status.style.color="#00ff99";

    // Reset
    document.getElementById("fileInput").value="";
    document.getElementById("fileName").value="";
    document.getElementById("tags").value="";
};
            </script>

</body>
</html>
